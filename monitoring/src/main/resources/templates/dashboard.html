<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScheduleFlow ëª¨ë‹ˆí„°ë§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #334155;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .status-healthy { background: #059669; color: white; }
        .status-warning { background: #d97706; color: white; }
        .status-critical { background: #dc2626; color: white; animation: pulse 1s infinite; }
        .status-unknown { background: #6b7280; color: white; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .card {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #334155;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #94a3b8;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .icon-system { background: #3b82f6; }
        .icon-docker { background: #0ea5e9; }
        .icon-runner { background: #8b5cf6; }
        .icon-alert { background: #ef4444; }

        .metric {
            margin-bottom: 16px;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .metric-label {
            font-size: 14px;
            color: #94a3b8;
        }

        .metric-value {
            font-size: 14px;
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: #334155;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-ok { background: #22c55e; }
        .progress-warning { background: #eab308; }
        .progress-danger { background: #ef4444; }

        .container-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .container-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: #0f172a;
            border-radius: 8px;
        }

        .container-name {
            font-weight: 500;
        }

        .container-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .dot-running { background: #22c55e; }
        .dot-stopped { background: #ef4444; }
        .dot-restarting { background: #eab308; animation: blink 1s infinite; }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .alert-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .alert-item {
            display: flex;
            gap: 12px;
            padding: 12px;
            background: #0f172a;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid;
        }

        .alert-critical { border-color: #ef4444; }
        .alert-warning { border-color: #eab308; }

        .alert-icon {
            font-size: 18px;
        }

        .alert-content {
            flex: 1;
        }

        .alert-message {
            font-size: 14px;
            margin-bottom: 4px;
        }

        .alert-time {
            font-size: 12px;
            color: #64748b;
        }

        .battery-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: #0f172a;
            border-radius: 8px;
            margin-top: 8px;
        }

        .battery-icon {
            font-size: 20px;
        }

        .runner-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: #0f172a;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .runner-labels {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .runner-label {
            font-size: 11px;
            padding: 2px 6px;
            background: #334155;
            border-radius: 4px;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: #64748b;
        }

        .timestamp {
            text-align: center;
            color: #64748b;
            font-size: 13px;
            margin-top: 20px;
        }

        .refresh-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .refresh-btn:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“Š ScheduleFlow ëª¨ë‹ˆí„°ë§</h1>
        <div style="display: flex; gap: 12px; align-items: center;">
            <span class="status-badge"
                  th:classappend="${health.overallStatus.name() == 'HEALTHY'} ? 'status-healthy' :
                                  (${health.overallStatus.name() == 'WARNING'} ? 'status-warning' :
                                  (${health.overallStatus.name() == 'CRITICAL'} ? 'status-critical' : 'status-unknown'))"
                  th:text="${health.overallStatus.name() == 'HEALTHY'} ? 'ì •ìƒ' :
                           (${health.overallStatus.name() == 'WARNING'} ? 'ê²½ê³ ' :
                           (${health.overallStatus.name() == 'CRITICAL'} ? 'ì¥ì• ' : 'ì•Œ ìˆ˜ ì—†ìŒ'))">
            </span>
            <button class="refresh-btn" onclick="location.reload()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </div>

    <div class="grid">
        <!-- System Resources -->
        <div class="card">
            <div class="card-header">
                <span class="card-title">ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤</span>
                <div class="card-icon icon-system">ğŸ’»</div>
            </div>

            <div th:if="${health.system != null}">
                <!-- CPU -->
                <div class="metric">
                    <div class="metric-header">
                        <span class="metric-label">CPU</span>
                        <span class="metric-value" th:text="${#numbers.formatDecimal(health.system.cpuUsage, 1, 1) + '%'}"></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"
                             th:classappend="${health.system.cpuUsage > 80} ? 'progress-danger' : (${health.system.cpuUsage > 60} ? 'progress-warning' : 'progress-ok')"
                             th:style="'width: ' + ${health.system.cpuUsage} + '%'"></div>
                    </div>
                </div>

                <!-- RAM -->
                <div class="metric">
                    <div class="metric-header">
                        <span class="metric-label">ë©”ëª¨ë¦¬</span>
                        <span class="metric-value" th:text="${#numbers.formatDecimal(health.system.ramUsage, 1, 1) + '%'}"></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"
                             th:classappend="${health.system.ramUsage > 80} ? 'progress-danger' : (${health.system.ramUsage > 60} ? 'progress-warning' : 'progress-ok')"
                             th:style="'width: ' + ${health.system.ramUsage} + '%'"></div>
                    </div>
                </div>

                <!-- SSD -->
                <div class="metric">
                    <div class="metric-header">
                        <span class="metric-label">ë””ìŠ¤í¬</span>
                        <span class="metric-value" th:text="${#numbers.formatDecimal(health.system.ssdUsage, 1, 1) + '%'}"></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"
                             th:classappend="${health.system.ssdUsage > 80} ? 'progress-danger' : (${health.system.ssdUsage > 60} ? 'progress-warning' : 'progress-ok')"
                             th:style="'width: ' + ${health.system.ssdUsage} + '%'"></div>
                    </div>
                </div>

                <!-- Battery -->
                <div class="battery-info" th:if="${health.system.batteryLevel != null}">
                    <span class="battery-icon" th:text="${health.system.isPowerConnected} ? 'ğŸ”Œ' : 'ğŸ”‹'"></span>
                    <span th:text="'ë°°í„°ë¦¬ ' + ${health.system.batteryLevel} + '%'"></span>
                    <span th:if="${health.system.isPowerConnected}" style="color: #22c55e;">ì¶©ì „ ì¤‘</span>
                </div>
            </div>
            <div th:if="${health.system == null}" class="empty-state">
                ë°ì´í„° ìˆ˜ì§‘ ì¤‘...
            </div>
        </div>

        <!-- Docker -->
        <div class="card">
            <div class="card-header">
                <span class="card-title">Docker ì»¨í…Œì´ë„ˆ</span>
                <div class="card-icon icon-docker">ğŸ³</div>
            </div>

            <div th:if="${health.docker != null}">
                <div th:if="${!health.docker.isDaemonRunning}" class="alert-item alert-critical">
                    <span class="alert-icon">âš ï¸</span>
                    <span>Docker ë°ëª¬ì´ ì‘ë‹µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</span>
                </div>

                <div class="container-list" th:if="${health.docker.isDaemonRunning}">
                    <div class="container-item" th:each="container : ${health.docker.containers}">
                        <span class="container-name" th:text="${container.name}"></span>
                        <div class="container-status">
                            <span class="status-dot"
                                  th:classappend="${container.isRunning} ? 'dot-running' : (${container.isRestarting} ? 'dot-restarting' : 'dot-stopped')"></span>
                            <span th:text="${container.state}"></span>
                        </div>
                    </div>
                    <div th:if="${#lists.isEmpty(health.docker.containers)}" class="empty-state">
                        ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ ì»¨í…Œì´ë„ˆ ì—†ìŒ
                    </div>
                </div>
            </div>
            <div th:if="${health.docker == null}" class="empty-state">
                ë°ì´í„° ìˆ˜ì§‘ ì¤‘...
            </div>
        </div>

        <!-- GitHub Runners -->
        <div class="card">
            <div class="card-header">
                <span class="card-title">GitHub Runners</span>
                <div class="card-icon icon-runner">ğŸƒ</div>
            </div>

            <div th:if="${!#lists.isEmpty(health.runners)}">
                <div class="runner-item" th:each="runner : ${health.runners}">
                    <div>
                        <div class="container-name" th:text="${runner.name}"></div>
                        <div class="runner-labels">
                            <span class="runner-label" th:each="label : ${runner.labels}" th:text="${label}"></span>
                        </div>
                    </div>
                    <div class="container-status">
                        <span class="status-dot" th:classappend="${runner.isOnline} ? 'dot-running' : 'dot-stopped'"></span>
                        <span th:text="${runner.isOnline} ? (${runner.isBusy} ? 'ì‘ì—… ì¤‘' : 'ëŒ€ê¸° ì¤‘') : 'ì˜¤í”„ë¼ì¸'"></span>
                    </div>
                </div>
            </div>
            <div th:if="${#lists.isEmpty(health.runners)}" class="empty-state">
                ë“±ë¡ëœ Runner ì—†ìŒ
            </div>
        </div>

        <!-- Alerts -->
        <div class="card">
            <div class="card-header">
                <span class="card-title">ìµœê·¼ ì•ŒëŒ</span>
                <div class="card-icon icon-alert">ğŸ””</div>
            </div>

            <div class="alert-list" th:if="${!#lists.isEmpty(health.recentAlerts)}">
                <div class="alert-item"
                     th:each="alert : ${health.recentAlerts}"
                     th:classappend="${alert.level.name() == 'CRITICAL'} ? 'alert-critical' : 'alert-warning'">
                    <span class="alert-icon" th:text="${alert.level.name() == 'CRITICAL'} ? 'ğŸ”´' : 'âš ï¸'"></span>
                    <div class="alert-content">
                        <div class="alert-message" th:text="${alert.message}"></div>
                        <div class="alert-time" th:text="${#temporals.format(alert.timestamp, 'MM-dd HH:mm:ss')}"></div>
                    </div>
                </div>
            </div>
            <div th:if="${#lists.isEmpty(health.recentAlerts)}" class="empty-state">
                ìµœê·¼ ì•ŒëŒ ì—†ìŒ âœ…
            </div>
        </div>
    </div>

    <div class="timestamp">
        ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span th:text="${#temporals.format(health.timestamp, 'yyyy-MM-dd HH:mm:ss')}"></span>
    </div>

    <script>
        // Auto refresh every 30 seconds
        setTimeout(() => location.reload(), 30000);
    </script>
</body>
</html>
